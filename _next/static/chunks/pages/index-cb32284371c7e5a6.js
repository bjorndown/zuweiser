(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,e,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(7396)}])},7396:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return Q}});var n=i(5893),r=i(536),a=i.n(r),s=i(7294),c=function(t){var e=t.onChange,i=(0,s.useState)("\t"),r=i[0];i[1];return(0,n.jsxs)("div",{className:"jsx-9dbe652c94c65d4c container",children:[(0,n.jsx)("textarea",{rows:20,onChange:function(t){return e(function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.split("\n").slice(e?1:0).map((function(t){return t.trim().split(r).map((function(t){return t.trim()}))})).filter((function(t){return 1!==t.length}))}(t.target.value))},className:"jsx-9dbe652c94c65d4c input"}),(0,n.jsx)(a(),{id:"9dbe652c94c65d4c",children:".container.jsx-9dbe652c94c65d4c{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column wrap;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-flow:column wrap;flex-flow:column wrap;margin:1rem 0}.input.jsx-9dbe652c94c65d4c{max-width:700px}"})]})},o=function(t){var e=t.text;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{title:e,className:"jsx-ced004547a5ed728 explanation",children:"?"}),(0,n.jsx)(a(),{id:"ced004547a5ed728",children:".explanation.jsx-ced004547a5ed728{background:var(--ok);margin-left:.3rem;padding:0 5px;font-weight:bold;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%}"})]})},l=i(4184),u=i.n(l),d=i(4598),f=i.n(d),h=function(t){var e=t.children,i=t.type;return(0,n.jsx)("p",{className:u()(f().container,i),children:e})},m=function(t){var e=t.error,i=t.columns,r=t.table;return(0,n.jsxs)(n.Fragment,{children:[e&&(0,n.jsx)(h,{type:"bad",children:e}),!e&&i.length>0&&(0,n.jsx)("div",{className:"jsx-75eb681a21301031 preview",children:(0,n.jsxs)("table",{className:"jsx-75eb681a21301031",children:[(0,n.jsx)("thead",{className:"jsx-75eb681a21301031",children:(0,n.jsx)("tr",{className:"jsx-75eb681a21301031",children:i.map((function(t){return(0,n.jsx)("th",{title:t.matchedAs?'Erkannt als "'.concat(t.matchedAsLabel,'"'):"",className:"jsx-75eb681a21301031 "+(u()({"matched-column":t.matchedAs})||""),children:t.label},t.label)}))})}),(0,n.jsx)("tbody",{className:"jsx-75eb681a21301031",children:r.slice(1).map((function(t,e){return(0,n.jsx)("tr",{className:"jsx-75eb681a21301031",children:t.map((function(t,i){return(0,n.jsx)("td",{className:"jsx-75eb681a21301031",children:t},"cell-".concat(e,"-").concat(i))}))},"row-".concat(e))}))})]})}),(0,n.jsx)(a(),{id:"75eb681a21301031",children:".preview.jsx-75eb681a21301031{height:10rem;overflow:auto}.matched-column.jsx-75eb681a21301031{background:var(--ok)}th.jsx-75eb681a21301031{position:-webkit-sticky;position:sticky;top:0;left:0}"})]})},x=function(t){var e,i,r=t.onChange,l=(0,s.useState)(!0),u=l[0],d=l[1],f=(0,s.useState)(),h=f[0],x=f[1],p=function(t){return"id"===t.toLowerCase()},b=function(t){return t.toLowerCase().startsWith("name")||t.toLowerCase().startsWith("titel")},v=function(t){return t.toLowerCase().includes("limit")||t.toLowerCase().includes("max")},j=function(t){return t.toLowerCase().includes("minimum")},y=(0,s.useMemo)((function(){return null!==(e=null===h||void 0===h?void 0:h[0])&&void 0!==e?e:[]}),[h]),g=(0,s.useMemo)((function(){return null!==(i=null===h||void 0===h?void 0:h.slice(1))&&void 0!==i?i:[]}),[h]),w=(0,s.useMemo)((function(){return y.indexOf(y.find((function(t){return p(t)})))}),[y]),N=(0,s.useMemo)((function(){return y.indexOf(y.find((function(t){return b(t)})))}),[y]),P=(0,s.useMemo)((function(){return y.indexOf(y.find((function(t){return v(t)})))}),[y]),k=(0,s.useMemo)((function(){return y.indexOf(y.find((function(t){return j(t)})))}),[y]),A=(0,s.useMemo)((function(){return y.length?y.map((function(t,e){return p(t)?{label:t,matchedAsLabel:"ID",matchedAs:"id"}:b(t)?{label:t,matchedAs:"title",matchedAsLabel:"Titel"}:v(t)?{label:t,matchedAs:"limit",matchedAsLabel:"Limit"}:j(t)?{label:t,matchedAs:"minimum",matchedAsLabel:"Minimum"}:{label:t,matchedAs:void 0,matchedAsLabel:void 0}})):[]}),[y]),M=(0,s.useMemo)((function(){if(h)return!A||A.length<3?"Keine oder zu wenige Spalten erkannt. Minimum an Spalten: ID, Titel, Limit, Minimum":!A.find((function(t){return"id"===t.matchedAs}))?'Spalte "ID" nicht erkannt':!A.find((function(t){return"title"===t.matchedAs}))?'Spalte "Titel" nicht erkannt':!A.find((function(t){return"limit"===t.matchedAs}))?'Spalte "Limit" nicht erkannt':!!A.find((function(t){return"minimum"===t.matchedAs}))?void 0:'Spalte "Minimum" nicht erkannt'}),[h,A]),S=(0,s.useMemo)((function(){return M||!g.length?[]:g.map((function(t){return{id:t[w],title:t[N],limit:parseInt(t[P]),minimum:parseInt(t[k])}}))}),[M,g,y]);return(0,s.useEffect)((function(){r(M?void 0:{activities:S,shuffleBeforeMatch:u})}),[M,S,u]),(0,n.jsxs)("div",{className:"jsx-62bbc98b497c4570 container",children:[(0,n.jsx)("h2",{className:"jsx-62bbc98b497c4570",children:"Aktivit\xe4ten"}),(0,n.jsx)("input",{type:"checkbox",id:"shuffleActivitiesBeforeMatch",checked:u,onChange:function(){return d(!u)},className:"jsx-62bbc98b497c4570"}),(0,n.jsxs)("label",{htmlFor:"shuffleActivitiesBeforeMatch",className:"jsx-62bbc98b497c4570",children:["Vor dem Zuweisen mischen",(0,n.jsx)(o,{text:"Ohne Mischen ist die Reihenfolge der Eintr\xe4ge in der Tabelle massgebend, d.h. fr\xfche Eintr\xe4ge werden bevorzugt"})]}),(0,n.jsx)(c,{onChange:function(t){return x(t)}}),(0,n.jsx)(m,{error:M,columns:A,table:h}),(0,n.jsx)(a(),{id:"62bbc98b497c4570",children:".container.jsx-62bbc98b497c4570{min-width:400px;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}"})]})},p=function(t){var e,i,r=t.onChange,l=(0,s.useState)(!0),u=l[0],d=l[1],f=(0,s.useState)(1),h=f[0],x=f[1],p=(0,s.useState)(),b=p[0],v=p[1],j=function(t){return"id"===t.toLowerCase()},y=function(t){return t.toLowerCase().includes("prio")||t.toLowerCase().includes("wahl")},g=(0,s.useMemo)((function(){return null!==(e=null===b||void 0===b?void 0:b[0])&&void 0!==e?e:[]}),[b]),w=(0,s.useMemo)((function(){return null!==(i=null===b||void 0===b?void 0:b.slice(1))&&void 0!==i?i:[]}),[b]),N=(0,s.useMemo)((function(){return g.indexOf(g.find((function(t){return j(t)})))}),[g]),P=(0,s.useMemo)((function(){return g.filter(y).map((function(t){return g.indexOf(t)}))}),[g]),k=(0,s.useMemo)((function(){return g.filter((function(t){return!y(t)&&!j(t)}))}),[g]),A=(0,s.useMemo)((function(){if(!g.length)return[];var t=g.filter(y);return g.map((function(e){return j(e)?{label:e,matchedAsLabel:"ID",matchedAs:"id"}:y(e)?{label:e,matchedAs:"priority",matchedAsLabel:"Priorit\xe4t ".concat(t.indexOf(e)+1)}:{label:e,matchedAs:void 0,matchedAsLabel:void 0}}))}),[g]),M=(0,s.useMemo)((function(){if(b){if(!A||A.length<3)return"Keine oder zu wenige Spalten erkannt. Minimum an Spalten: ID, Priorit\xe4t 1, Priorit\xe4t 2";if(!!!A.find((function(t){return"id"===t.matchedAs})))return'Spalte "ID" nicht erkannt';var t=A.filter((function(t){return"priority"===t.matchedAs})).length;return 0===t?"Keine Priorit\xe4ten-Spalten erkannt":1===t?"Nur eine Priorit\xe4ten-Spalten erkannt":void 0}}),[b,A]),S=(0,s.useMemo)((function(){return M||!b?[]:w.map((function(t){return{id:t[N],priorities:t.filter((function(t,e){return P.includes(e)})),otherAttributes:t.filter((function(t,e){return!P.concat(N).includes(e)}))}}))}),[M,b,w,N,P]);return(0,s.useEffect)((function(){r(M?void 0:{participants:S,shuffleBeforeMatch:u,activitiesPerPerson:h,prioritiesPerPerson:P.length,otherAttributesColumns:k})}),[M,S,u,h,P,k]),(0,n.jsxs)("div",{className:"jsx-e5979519b32ed23 container",children:[(0,n.jsx)("h2",{className:"jsx-e5979519b32ed23",children:"Teilnehmer"}),(0,n.jsx)("label",{htmlFor:"activitiesPerPerson",className:"jsx-e5979519b32ed23",children:"Aktivit\xe4ten pro Person"}),(0,n.jsx)("input",{id:"activitiesPerPerson",type:"number",value:h,onChange:function(t){return x(parseInt(t.target.value))},maxLength:1,size:3,className:"jsx-e5979519b32ed23"}),(0,n.jsx)("input",{type:"checkbox",id:"shuffleParticipantsBeforeMatch",checked:u,onChange:function(){return d(!u)},className:"jsx-e5979519b32ed23"}),(0,n.jsxs)("label",{htmlFor:"shuffleParticipantsBeforeMatch",className:"jsx-e5979519b32ed23",children:["Vor dem Zuweisen mischen",(0,n.jsx)(o,{text:"Ohne Mischen ist die Reihenfolge der Eintr\xe4ge in der Tabelle massgebend, d.h. fr\xfche Eintr\xe4ge werden bevorzugt"})]}),(0,n.jsx)(c,{onChange:function(t){return v(t)}}),(0,n.jsx)(m,{error:M,columns:A,table:b}),(0,n.jsx)(a(),{id:"e5979519b32ed23",children:".container.jsx-e5979519b32ed23{min-width:500px;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}"})]})},b=function(t){var e=t.fulfilledPriorities,i=t.totalParticipants;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("ol",{children:e.map((function(t,e){return(0,n.jsxs)("li",{children:["Priorit\xe4t"," ",(0,n.jsx)("progress",{value:t,max:i})," ",t]},"priority-".concat(e))}))})})},v=i(6026),j=i.n(v),y=function(t){var e=t.result,i=t.particpantsConfig,r=function(t){return"".concat(t+1,". Priorit\xe4t")};return(0,n.jsxs)("div",{className:"jsx-1eb6440d3202b42d",children:[(0,n.jsxs)("article",{className:"jsx-1eb6440d3202b42d statistics",children:[(0,n.jsxs)("section",{className:"jsx-1eb6440d3202b42d",children:[(0,n.jsx)("h3",{className:"jsx-1eb6440d3202b42d",children:"Kurz\xfcbersicht"}),(0,n.jsxs)("table",{className:"jsx-1eb6440d3202b42d",children:[(0,n.jsx)("thead",{className:"jsx-1eb6440d3202b42d",children:(0,n.jsxs)("tr",{className:"jsx-1eb6440d3202b42d",children:[(0,n.jsx)("th",{className:"jsx-1eb6440d3202b42d",children:"Kurs"}),j()(0,i.activitiesPerPerson).map((function(t){return(0,n.jsxs)("th",{className:"jsx-1eb6440d3202b42d",children:["Durchf\xfchrung ",t+1]})})),(0,n.jsx)("th",{className:"jsx-1eb6440d3202b42d",children:"Minimum"}),(0,n.jsx)("th",{className:"jsx-1eb6440d3202b42d",children:"Limit"})]})}),(0,n.jsxs)("tbody",{className:"jsx-1eb6440d3202b42d",children:[e.activities.map((function(t){return(0,n.jsxs)("tr",{className:"jsx-1eb6440d3202b42d",children:[(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d",children:t.title}),j()(0,i.activitiesPerPerson).map((function(e){var i;return(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d number",children:null===(i=t.participants[e+1])||void 0===i?void 0:i.length})})),(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d number",children:t.minimum}),(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d number",children:t.limit})]},"activity-".concat(t.id))})),(0,n.jsxs)("tr",{className:"jsx-1eb6440d3202b42d totals",children:[(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d",children:"Total"}),j()(0,i.activitiesPerPerson).map((function(t){return(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d number",children:e.activities.reduce((function(e,i){return i.participantsByExecution(t+1).length+e}),0)})})),(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d number",children:e.activities.map((function(t){return t.minimum})).reduce((function(t,e){return t+e}))}),(0,n.jsx)("td",{className:"jsx-1eb6440d3202b42d number",children:e.activities.map((function(t){return t.limit})).reduce((function(t,e){return t+e}))})]})]})]})]}),(0,n.jsxs)("section",{className:"jsx-1eb6440d3202b42d",children:[(0,n.jsx)("h3",{className:"jsx-1eb6440d3202b42d",children:"Verteilung der erf\xfcllten Priorit\xe4ten"}),(0,n.jsx)(b,{fulfilledPriorities:function(t){var e={},i=!0,n=!1,a=void 0;try{for(var s,c=t.activities[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var o=s.value,l=!0,u=!1,d=void 0;try{for(var f,h=j()(1)[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){f.value;var m=!0,x=!1,p=void 0;try{for(var b,v=o.allParticipants()[Symbol.iterator]();!(m=(b=v.next()).done);m=!0){var y=b.value.priorities.indexOf(o.id);e[r(y)]?e[r(y)]++:e[r(y)]=1}}catch(g){x=!0,p=g}finally{try{m||null==v.return||v.return()}finally{if(x)throw p}}}}catch(g){u=!0,d=g}finally{try{l||null==h.return||h.return()}finally{if(u)throw d}}}}catch(g){n=!0,a=g}finally{try{i||null==c.return||c.return()}finally{if(n)throw a}}return Object.keys(e).map((function(t){return e[t]}))}(e),totalParticipants:e.participants.length})]})]}),(0,n.jsx)(a(),{id:"1eb6440d3202b42d",children:".statistics.jsx-1eb6440d3202b42d{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row wrap;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;gap:1rem}"})]})},g=function(t){var e=t.result,i=t.participantsConfig,r=(0,s.useState)(!1),c=r[0],o=r[1];return(0,n.jsxs)("div",{className:"jsx-f64233d701ae89c container",children:[(0,n.jsx)("h3",{className:"jsx-f64233d701ae89c",children:c?"Alle Teilnehmer":"Teilnehmer mit zu wenig Aktivit\xe4ten"}),(0,n.jsx)("label",{htmlFor:"showAllParticipants",className:"jsx-f64233d701ae89c",children:"Alle Teilnehmer zeigen"}),(0,n.jsx)("input",{id:"showAllParticipants",type:"checkbox",checked:c,onChange:function(t){return o(!c)},className:"jsx-f64233d701ae89c"}),(0,n.jsx)("div",{className:"jsx-f64233d701ae89c fixed-header-scroll-container",children:(0,n.jsxs)("table",{className:"jsx-f64233d701ae89c",children:[(0,n.jsx)("thead",{className:"jsx-f64233d701ae89c",children:(0,n.jsxs)("tr",{className:"jsx-f64233d701ae89c",children:[(0,n.jsx)("th",{className:"jsx-f64233d701ae89c",children:"ID"}),i.otherAttributesColumns.map((function(t){return(0,n.jsx)("th",{className:"jsx-f64233d701ae89c",children:t})})),j()(0,i.prioritiesPerPerson).map((function(t){return(0,n.jsxs)("th",{className:"jsx-f64233d701ae89c",children:["Priorit\xe4t ",t+1]},t)})),j()(0,i.activitiesPerPerson).map((function(t){return(0,n.jsxs)("th",{className:"jsx-f64233d701ae89c",children:["Kurs ",t+1]})}))]})}),(0,n.jsx)("tbody",{className:"jsx-f64233d701ae89c",children:e.participants.filter((function(t){return!!c||t.needsMoreActivities()})).sort((function(t,e){return t.activities.length-e.activities.length})).map((function(t,r){return(0,n.jsxs)("tr",{className:"jsx-f64233d701ae89c",children:[(0,n.jsx)("td",{className:"jsx-f64233d701ae89c",children:t.id}),t.otherAttributes.map((function(t,e){return(0,n.jsx)("td",{className:"jsx-f64233d701ae89c",children:t},"property-".concat(e))})),t.priorities.map((function(i){var r=e.activities.find((function(t){return t.id===i})),a=t.activities.find((function(t){return t.activity.id===r.id}));return(0,n.jsx)("td",{className:"jsx-f64233d701ae89c "+(u()({assigned:!!a})||""),children:(0,n.jsx)(n.Fragment,{children:a?"".concat(r.title," (").concat(a.execution,")"):r.title})},i)})),j()(0,i.activitiesPerPerson).map((function(e){var i=t.activities[e];return i?(0,n.jsx)("td",{className:"jsx-f64233d701ae89c",children:"".concat(i.activity.title," ").concat(i.execution)},e):(0,n.jsx)("td",{className:"jsx-f64233d701ae89c"},e)}))]},"participant-".concat(t.id,"-").concat(r))}))})]})}),(0,n.jsx)(a(),{id:"f64233d701ae89c",children:".container.jsx-f64233d701ae89c{}.assigned.jsx-f64233d701ae89c{font-weight:bold}.fixed-header-scroll-container.jsx-f64233d701ae89c{max-height:55rem;overflow:auto}th.jsx-f64233d701ae89c{position:-webkit-sticky;position:sticky;top:0;left:0}"})]})},w=function(t){var e=t.activity,i=t.participantsConfig,r=t.result,c=(0,s.useMemo)((function(){return e.participantsWithExecution()}),[e]),o=function(t){return t.otherAssignedActivities(e).map((function(t){var e=t.activity,i=t.priority;return"".concat(e.title," (Prio ").concat(i+1,")")})).join(", ")};return(0,n.jsxs)("article",{className:"jsx-74bce0fcf5fa9ef6 matched-activity-container",children:[(0,n.jsx)("h4",{className:"jsx-74bce0fcf5fa9ef6",children:function(t){return"".concat(t.title," (").concat(c.length," / ").concat(t.limit*i.activitiesPerPerson,")")}(e)}),(0,n.jsxs)("table",{className:"jsx-74bce0fcf5fa9ef6 matching-result",children:[(0,n.jsx)("thead",{className:"jsx-74bce0fcf5fa9ef6",children:(0,n.jsxs)("tr",{className:"jsx-74bce0fcf5fa9ef6",children:[(0,n.jsx)("th",{className:"jsx-74bce0fcf5fa9ef6",children:"#"}),i.otherAttributesColumns.map((function(t){return(0,n.jsx)("th",{className:"jsx-74bce0fcf5fa9ef6",children:t})})),(0,n.jsx)("th",{className:"jsx-74bce0fcf5fa9ef6",children:"Priorit\xe4t"}),i.activitiesPerPerson>1&&(0,n.jsx)("th",{className:"jsx-74bce0fcf5fa9ef6",children:"Durchf\xfchrung"})]})}),(0,n.jsx)("tbody",{className:"jsx-74bce0fcf5fa9ef6",children:c.map((function(t,a){var s=t.participant,c=t.execution;return(0,n.jsxs)("tr",{title:i.activitiesPerPerson>1?"Andere Kurse: ".concat(o(s)):"",onClick:function(){return console.log("Alternativen",s.otherPossiblePriorities(r.activities))},className:"jsx-74bce0fcf5fa9ef6",children:[(0,n.jsx)("td",{className:"jsx-74bce0fcf5fa9ef6",children:a+1}),s.otherAttributes.map((function(t,e){return(0,n.jsx)("td",{className:"jsx-74bce0fcf5fa9ef6",children:t},"property-".concat(e))})),(0,n.jsx)("td",{className:"jsx-74bce0fcf5fa9ef6 priority-column",children:s.priorities.indexOf(e.id)+1}),i.activitiesPerPerson>1&&(0,n.jsx)("td",{className:"jsx-74bce0fcf5fa9ef6",children:c})]},"participant-".concat(s.id))}))})]}),(0,n.jsx)(a(),{id:"74bce0fcf5fa9ef6",children:"table.matching-result.jsx-74bce0fcf5fa9ef6{min-width:350px;max-width:550px}.matched-activity-container.jsx-74bce0fcf5fa9ef6{display:block}.priority-column.jsx-74bce0fcf5fa9ef6{text-align:center}"})]},"activity-".concat(e.id))},N=function(t){var e=t.result,i=t.participantsConfig;return e.participants.map((function(t){var i=t.otherPossiblePriorities(e.activities);i.length&&console.log("possible",t,i)})),(0,n.jsxs)("div",{className:"jsx-9ca720909a472cb3",children:[(0,n.jsx)("h2",{className:"jsx-9ca720909a472cb3",children:"Resultat"}),(0,n.jsx)(y,{result:e,particpantsConfig:i}),(0,n.jsx)(g,{result:e,participantsConfig:i}),(0,n.jsxs)("section",{className:"jsx-9ca720909a472cb3",children:[(0,n.jsx)("h3",{className:"jsx-9ca720909a472cb3",children:"Zuweisungen pro Kurs"}),(0,n.jsx)("div",{className:"jsx-9ca720909a472cb3 matching-results",children:e.activities.map((function(t){return(0,n.jsx)(w,{activity:t,participantsConfig:i,result:e},"activity-".concat(t.id))}))})]}),(0,n.jsx)(a(),{id:"9ca720909a472cb3",children:".matching-results.jsx-9ca720909a472cb3{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row wrap;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;gap:1rem}"})]})},P=i(9983),k=i.n(P),A=i(4111),M=i(1438),S=i(2951),C=i(8668),z=i(603),E=i(5892),T=i(6626),L=i(4051),O=i.n(L),B=function(){function t(e,i){(0,M.Z)(this,t),this.participant=e,this.config=i,this.activities=[]}var e=t.prototype;return e.assign=function(t,e){if(!this.needsMoreActivities())throw new Error("Participant has reached limit of activities per person");if(this.isAssignedTo(t,e))throw new Error("Participant is already assigned to this activity");this.activities.push({activity:t,execution:e})},e.isAssignedTo=function(t,e){return this.activities.some((function(i){return i.activity.id===t.id&&i.execution===e}))},e.canBeAssignedTo=function(t,e){var i=this.activities.some((function(t){return t.execution===e})),n=this.activities.some((function(e){return e.activity.id===t.id}));return this.needsMoreActivities()&&!this.isAssignedTo(t,e)&&t.isNotFull(e)&&!i&&!n},e.needsMoreActivities=function(){return this.activities.length<this.config.activitiesPerPerson},e.otherAssignedActivities=function(t){var e=this;return this.activities.filter((function(e){return e.activity.id!==t.id})).map((function(t){var i=t.activity;t.execution;return{activity:i,priority:e.priorities.indexOf(i.id)}}))},e.otherPossiblePriorities=function(t){var e=this;return this.priorities.map((function(e){return t.find((function(t){return t.id===e}))})).map((function(t){return j()(1,e.config.activitiesPerPerson+1).map((function(i){return{execution:i,activity:t,canBeAssigned:e.canBeAssignedTo(t,i),priority:e.priorities.indexOf(t.id)}}))})).flat().filter((function(t){return t.canBeAssigned}))},(0,S.Z)(t,[{key:"id",get:function(){return this.participant.id}},{key:"priorities",get:function(){return this.participant.priorities}},{key:"otherAttributes",get:function(){return this.participant.otherAttributes}}]),t}(),Z=function(){function t(e,i){var n=this;(0,M.Z)(this,t),this.activity=e,this.participants={},j()(1,i.activitiesPerPerson+1).forEach((function(t){return n.participants[t]=[]}))}var e=t.prototype;return e.allParticipants=O().mark((function t(){var e,i,n,r,a,s,c,o,l,u,d,f,h;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=!0,i=!1,n=void 0,t.prev=1,r=Object.entries(this.participants)[Symbol.iterator]();case 3:if(e=(a=r.next()).done){t.next=32;break}s=(0,z.Z)(a.value,2),s[0],c=s[1],o=!0,l=!1,u=void 0,t.prev=6,d=c[Symbol.iterator]();case 8:if(o=(f=d.next()).done){t.next=15;break}return h=f.value,t.next=12,h;case 12:o=!0,t.next=8;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(6),l=!0,u=t.t0;case 21:t.prev=21,t.prev=22,o||null==d.return||d.return();case 24:if(t.prev=24,!l){t.next=27;break}throw u;case 27:return t.finish(24);case 28:return t.finish(21);case 29:e=!0,t.next=3;break;case 32:t.next=38;break;case 34:t.prev=34,t.t1=t.catch(1),i=!0,n=t.t1;case 38:t.prev=38,t.prev=39,e||null==r.return||r.return();case 41:if(t.prev=41,!i){t.next=44;break}throw n;case 44:return t.finish(41);case 45:return t.finish(38);case 46:case"end":return t.stop()}}),t,this,[[1,34,38,46],[6,17,21,29],[22,,24,28],[39,,41,45]])})),e.participantsByExecution=function(t){var e;return null!==(e=this.participants[t])&&void 0!==e?e:[]},e.participantsWithExecution=function(){return Object.entries(this.participants).map((function(t){var e=(0,z.Z)(t,2),i=e[0];return e[1].map((function(t){return{participant:t,execution:i}}))})).flat(2)},e.assignParticipant=function(t,e){if(!this.isNotFull(e))throw new Error('Activity title="'.concat(this.title," is full"));if(this.participants[e].some((function(e){return e.id===t.id})))throw new Error("Participant already in this activity");this.participants[e].push(t),t.assign(this,e)},e.isNotFull=function(t){return this.participants[t].length<this.limit},(0,S.Z)(t,[{key:"id",get:function(){return this.activity.id}},{key:"minimum",get:function(){return this.activity.minimum}},{key:"limit",get:function(){return this.activity.limit}},{key:"title",get:function(){return this.activity.title}}]),t}(),_=function(t){(0,C.Z)(i,t);var e=(0,T.Z)(i);function i(t,n,r,a){var s;return(0,M.Z)(this,i),(s=e.call(this,"".concat(r,"=").concat(a," not unique for ").concat(t," with id=").concat(n))).entityType=t,s.entityId=n,s.propertyName=r,s.propertyValue=a,Object.setPrototypeOf((0,A.Z)(s),i.prototype),s}return i}((0,E.Z)(Error)),F=function(t){(0,C.Z)(i,t);var e=(0,T.Z)(i);function i(t,n,r,a){var s;return(0,M.Z)(this,i),(s=e.call(this,"".concat(t," with id=").concat(n," does not exist. Referred to by ").concat(r," with id=").concat(a))).entityType=t,s.id=n,s.referrerType=r,s.referrerId=a,Object.setPrototypeOf((0,A.Z)(s),i.prototype),s}return i}((0,E.Z)(Error)),I=function(t,e){!function(t){var e=new Set;t.forEach((function(t){if(e.has(t.id))throw new _("Activity",t.id,"id",t.id);e.add(t.id)}))}(e),function(t){var e=new Set;t.forEach((function(t){if(e.has(t.id))throw new _("Participant",t.id,"id",t.id);e.add(t.id)}))}(t),function(t){t.forEach((function(t){if(t.priorities.length!==new Set(t.priorities).size)throw new _("Participant",t.id,"priorities",t.priorities.toString())}))}(t),function(t,e){var i=e.map((function(t){return t.id}));t.forEach((function(t){t.priorities.forEach((function(e){if(!i.find((function(t){return t===e})))throw new F("Activity",e,"Participant",t.id)}))}))}(t,e)};var D=function(t,e,i){var n=K(e),r=i.prioritiesPerPerson,a=!0,s=!1,c=void 0;try{for(var o,l=n[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var u=o.value,d=!0,f=!1,h=void 0;try{for(var m,x=j()(1,i.activitiesPerPerson+1)[Symbol.iterator]();!(d=(m=x.next()).done);d=!0){var p=m.value,b=V(t,u,r);console.log(u.title);var v=W(u,b,r);console.log("Minimal priority to fill to minimum ".concat(v.priority+1,", index ").concat(v.index));var y=!0,g=!1,w=void 0;try{for(var N,P=j()(r)[Symbol.iterator]();!(y=(N=P.next()).done);y=!0){var k=N.value;console.log("Prio ".concat(k+1,": ").concat(b[k].length))}}catch(jt){g=!0,w=jt}finally{try{y||null==P.return||P.return()}finally{if(g)throw w}}X(u,b,v,p)}}catch(jt){f=!0,h=jt}finally{try{d||null==x.return||x.return()}finally{if(f)throw h}}}}catch(jt){s=!0,c=jt}finally{try{a||null==l.return||l.return()}finally{if(s)throw c}}console.log("Second round");var A=!0,M=!1,S=void 0;try{for(var C,z=j()(1,i.activitiesPerPerson+1)[Symbol.iterator]();!(A=(C=z.next()).done);A=!0){var E=C.value,T=!0,L=!1,O=void 0;try{for(var B,Z=q(n,E)[Symbol.iterator]();!(T=(B=Z.next()).done);T=!0){var _=B.value,F=V(t,_,r),I=_.minimum-_.participants[E].length,D=F.flat();for(console.log("Try to fill delta ".concat(I," for ").concat(_.title));D.length>0&&_.minimum-_.participants[E].length>0;){var R=D.shift();R.canBeAssignedTo(_,E)&&_.assignParticipant(R,E)}}}catch(jt){L=!0,O=jt}finally{try{T||null==Z.return||Z.return()}finally{if(L)throw O}}}}catch(jt){M=!0,S=jt}finally{try{A||null==z.return||z.return()}finally{if(M)throw S}}console.log("final round");var H=!0,J=!1,Q=void 0;try{for(var U,Y=G(n,t,r)[Symbol.iterator]();!(H=(U=Y.next()).done);H=!0){var $=U.value,tt=!0,et=!1,it=void 0;try{for(var nt,rt=j()(1,i.activitiesPerPerson+1)[Symbol.iterator]();!(tt=(nt=rt.next()).done);tt=!0){var at=nt.value,st=V(t,$,r),ct=!0,ot=!1,lt=void 0;try{for(var ut,dt=j()(r)[Symbol.iterator]();!(ct=(ut=dt.next()).done);ct=!0){var ft=ut.value,ht=!0,mt=!1,xt=void 0;try{for(var pt,bt=j()(st[ft].length)[Symbol.iterator]();!(ht=(pt=bt.next()).done);ht=!0){pt.value;var vt=st[ft].shift();vt.canBeAssignedTo($,at)&&$.assignParticipant(vt,at)}}catch(jt){mt=!0,xt=jt}finally{try{ht||null==bt.return||bt.return()}finally{if(mt)throw xt}}}}catch(jt){ot=!0,lt=jt}finally{try{ct||null==dt.return||dt.return()}finally{if(ot)throw lt}}}}catch(jt){et=!0,it=jt}finally{try{tt||null==rt.return||rt.return()}finally{if(et)throw it}}}}catch(jt){J=!0,Q=jt}finally{try{H||null==Y.return||Y.return()}finally{if(J)throw Q}}},K=function(t){return t.filter((function(t){return t.limit>0}))},V=function(t,e,i){var n=j()(i).map((function(){return[]})),r=!0,a=!1,s=void 0;try{for(var c,o=function(){var t=c.value;n.forEach((function(i,r){t.priorities[r]===e.id&&n[r].push(t)}))},l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)o()}catch(u){a=!0,s=u}finally{try{r||null==l.return||l.return()}finally{if(a)throw s}}return n},R=function(t){return t.filter((function(t){return t.needsMoreActivities()}))},W=function(t,e,i){for(var n=0,r=[],a=e.map((function(t){return t.slice(0)}));r.length<t.minimum&&a.flat().length>0&&n<i;){if(0===a[n].length&&n<i&&(n+=1),r.push(a[n].shift()),0===a.flat().length&&r.length<t.minimum)return{priority:-1,index:-1};if(r.length===t.minimum)break}return{priority:n,index:e[n].length-a[n].length-1}},X=function(t,e,i,n){var r=!0,a=!1,s=void 0;try{for(var c,o=j()(i.priority)[Symbol.iterator]();!(r=(c=o.next()).done);r=!0){var l=c.value,u=!0,d=!1,f=void 0;try{for(var h,m=j()(e[l].length)[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){h.value;var x=e[l].shift();x.canBeAssignedTo(t,n)&&t.assignParticipant(x,n)}}catch(N){d=!0,f=N}finally{try{u||null==m.return||m.return()}finally{if(d)throw f}}}}catch(N){a=!0,s=N}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}var p=!0,b=!1,v=void 0;try{for(var y,g=j()(i.index+1)[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){y.value;var w=e[i.priority].shift();w.canBeAssignedTo(t,n)&&t.assignParticipant(w,n)}}catch(N){b=!0,v=N}finally{try{p||null==g.return||g.return()}finally{if(b)throw v}}},q=function(t,e){return t.sort((function(t,i){var n=t.minimum-t.participants[e].length;return i.minimum-i.participants[e].length-n}))},G=function(t,e,i){return t.sort((function(t,n){var r=!0,a=!1,s=void 0;try{for(var c,o=j()(i)[Symbol.iterator]();!(r=(c=o.next()).done);r=!0){var l=c.value,u=V(e,t,i),d=V(e,n,i);if(R(d[l]).length>R(u[l]).length)return 1;if(R(u[l]).length>R(d[l]).length)return-1}}catch(f){a=!0,s=f}finally{try{r||null==o.return||o.return()}finally{if(a)throw s}}return 0}))},H=function(t){var e=t.participantsConfig,i=t.activitiesConfig,r=function(t,i){return e.participants.reduce((function(e,n){return n.priorities[t]===i?e+1:e}),0)};return(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"Verteilung der Priorit\xe4ten pro Kurs"}),(0,n.jsxs)("table",{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"ID"}),(0,n.jsx)("th",{children:"Titel"}),(0,n.jsx)("th",{children:"Minimum"}),(0,n.jsx)("th",{children:"Maximum"}),j()(1,e.prioritiesPerPerson+1).map((function(t,e){return(0,n.jsxs)("th",{children:["Anzahl Prio ",e+1]},"prio".concat(e))}))]})}),(0,n.jsx)("tbody",{children:i.activities.map((function(t){return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:t.id}),(0,n.jsx)("td",{children:t.title}),(0,n.jsx)("td",{children:t.minimum}),(0,n.jsx)("td",{children:t.limit}),j()(0,e.prioritiesPerPerson).map((function(e,i){return(0,n.jsx)("td",{children:r(e,t.id)},"prio".concat(i))}))]},"activity".concat(t.id))}))})]})]})},J=function(t){var e=t.participantsConfig,i=t.activitiesConfig,r=(0,s.useMemo)((function(){return e.participants.length}),[i,e]),a=(0,s.useMemo)((function(){return i.activities.reduce((function(t,e){return t+e.limit}),0)}),[i,e]);return a<r?(0,n.jsxs)(h,{type:"bad",children:["Es fehlen ",r-a," Pl\xe4tze. Im Moment werden ",a," Pl\xe4tze angeboten. F\xfcr"," ",e.participants.length," Teilnehmer:innen, die"," ",e.activitiesPerPerson," Aktivit\xe4ten besuchen sollen, werden mindestens ",r," Pl\xe4tze ben\xf6tigt."]}):null},Q=function(){var t=(0,s.useState)(),e=t[0],i=t[1],r=(0,s.useState)(),c=r[0],o=r[1],l=(0,s.useState)(),u=l[0],d=l[1],f=(0,s.useState)(),m=f[0],b=f[1],v=(0,s.useMemo)((function(){var t,i;return(null===e||void 0===e||null===(t=e.activities)||void 0===t?void 0:t.length)&&(null===c||void 0===c||null===(i=c.participants)||void 0===i?void 0:i.length)}),[e,c]);(0,s.useEffect)((function(){d(void 0)}),[e,c]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"jsx-71568fd074756783",children:"Zuweiser"}),(0,n.jsxs)("div",{id:"config",className:"jsx-71568fd074756783",children:[(0,n.jsx)(x,{onChange:function(t){b(void 0),i(t)}}),(0,n.jsx)(p,{onChange:function(t){b(void 0),o(t)}})]}),v&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(H,{participantsConfig:c,activitiesConfig:e}),(0,n.jsx)(J,{participantsConfig:c,activitiesConfig:e}),(0,n.jsx)("button",{onClick:function(){try{d(function(t,e){I(t.participants,e.activities);var i=(t.shuffleBeforeMatch?k()(t.participants):t.participants).map((function(e){return new B(e,t)})),n=(e.shuffleBeforeMatch?k()(e.activities):e.activities).map((function(e){return new Z(e,t)}));return D(i,n,t),{participants:i,activities:n}}(c,e))}catch(m){console.error(m),b(m)}},className:"jsx-71568fd074756783 matchButton",children:"Priorit\xe4ten aufl\xf6sen"}),m&&(0,n.jsx)(h,{type:"bad",children:m.message})]}),u&&(0,n.jsx)(N,{result:u,participantsConfig:c}),(0,n.jsx)(a(),{id:"71568fd074756783",children:"@media screen and (min-width:500px){#config.jsx-71568fd074756783{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column wrap;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-flow:column wrap;flex-flow:column wrap}}#config.jsx-71568fd074756783{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row wrap;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-column-gap:1rem;-moz-column-gap:1rem;column-gap:1rem}.matchButton.jsx-71568fd074756783{margin-top:1rem;padding:.5rem;font-size:larger}"})]})}},4598:function(t){t.exports={container:"Message_container__uABwy"}}},function(t){t.O(0,[302,774,888,179],(function(){return e=8312,t(t.s=e);var e}));var e=t.O();_N_E=e}]);